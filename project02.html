<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆâ‘¡ é¡§å®¢ç”¨è³‡æ–™ä½œæˆã®è‡ªå‹•åŒ– | ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³æ‰‹é †æ›¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: #f8fafc;
            color: #0f172a;
            line-height: 1.7;
        }

        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 2rem;
        }

        .header-content {
            max-width: 1000px;
            margin: 0 auto;
        }

        .breadcrumb {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: white;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .project-number {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.05rem;
            opacity: 0.95;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .section h2 {
            font-size: 1.4rem;
            color: #f5576c;
            margin-bottom: 1.2rem;
            padding-bottom: 0.7rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .section h3 {
            font-size: 1.1rem;
            color: #f093fb;
            margin: 1.5rem 0 1rem 0;
        }

        .reference-link {
            display: block;
            background: #f8fafc;
            border: 2px solid #f5576c;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            color: #f5576c;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .reference-link:hover {
            background: #f5576c;
            color: white;
            transform: translateX(5px);
        }

        .flow-list {
            list-style: none;
            counter-reset: flow-counter;
        }

        .flow-item {
            padding: 1rem 0;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            align-items: start;
            gap: 1rem;
            counter-increment: flow-counter;
        }

        .flow-item:last-child {
            border-bottom: none;
        }

        .flow-number {
            width: 36px;
            height: 36px;
            min-width: 36px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
            font-weight: 700;
            margin-top: 0.2rem;
        }

        .flow-number::before {
            content: counter(flow-counter);
        }

        .flow-content {
            flex: 1;
        }

        .flow-title {
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 0.5rem;
            font-size: 1.05rem;
        }

        .flow-desc {
            color: #64748b;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .requirement-box {
            background: #fff3cd;
            border-left: 4px solid #f59e0b;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .requirement-box strong {
            color: #d97706;
            display: block;
            margin-bottom: 0.5rem;
        }

        .requirement-box ul {
            margin-left: 1.5rem;
            margin-top: 0.5rem;
        }

        .requirement-box li {
            margin-bottom: 0.3rem;
        }

        .goal-box {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .goal-box strong {
            color: #059669;
            display: block;
            margin-bottom: 0.5rem;
        }

        .sheet-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.75rem 0;
        }

        .sheet-card h4 {
            color: #f5576c;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .sheet-card p {
            font-size: 0.9rem;
            color: #64748b;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            position: relative;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
        }

        .code-block-title {
            color: #fbbf24;
            font-weight: 700;
            margin-bottom: 1rem;
            font-size: 1rem;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .copy-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #f5576c;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .copy-button:hover {
            background: #f093fb;
            transform: translateY(-2px);
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .btn {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background: #f5576c;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #f093fb;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #64748b;
        }

        .btn-secondary:hover {
            background: #475569;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .section {
                padding: 1.5rem;
            }

            .header h1 {
                font-size: 1.6rem;
            }

            .copy-button {
                position: static;
                display: block;
                margin-bottom: 1rem;
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="header-content">
            <div class="breadcrumb">
                <a href="index.html">â† ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ã«æˆ»ã‚‹</a>
            </div>
            <div class="project-number">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆâ‘¡</div>
            <h1>é¡§å®¢ç”¨è³‡æ–™ä½œæˆã®è‡ªå‹•åŒ–</h1>
            <p>ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—æ•™è‚²ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« + è¬›åº§è©³ç´°ã®è‡ªå‹•ãƒãƒ¼ã‚¸ã‚·ã‚¹ãƒ†ãƒ </p>
        </div>
    </header>

    <div class="container">
        <div class="section">
            <h2>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦</h2>
            <p>é¡§å®¢ã«æå‡ºã™ã‚‹ã€Œã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—æ•™è‚²ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ã¨ã€Œè¬›åº§è©³ç´°ã€ã‚’ä¸€ä½“ã§ä½œæˆã™ã‚‹æ¥­å‹™ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚è·ç¨®åˆ¥ãƒ»å¹´æ¬¡åˆ¥ã®ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ ææ¡ˆè¡¨ã«é€£å‹•ã—ã¦ã€è¬›åº§è©³ç´°ã‚·ãƒ¼ãƒˆãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚</p>

            <a href="https://docs.google.com/spreadsheets/d/1j0nHAcpBYNqROU2YdGbtiwJcm-9BHr09mVcLOyj_wa4/edit?gid=420015538#gid=420015538"
                class="reference-link" target="_blank">
                ğŸ“Š ç¾çŠ¶ãƒ‡ãƒ¢ï¼ˆApps Scriptï¼‰ã‚’é–‹ã
            </a>
        </div>

        <div class="section">
            <h2>å¯¾è±¡æˆæœç‰©ï¼ˆé¡§å®¢æå‡ºç‰©ã®æ§‹æˆï¼‰</h2>

            <h3>1. ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—æ•™è‚²ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆå¹´é–“8æ™‚é–“ã®ææ¡ˆè¡¨ï¼‰</h3>
            <p style="margin-bottom: 1rem;">è·ç¨®åˆ¥ã«ã€1å¹´ç›®ã€œ5å¹´ç›®ä»¥é™ã¾ã§ã®å¹´ã”ã¨ã®ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ ã‚’ææ¡ˆã—ã¾ã™ã€‚</p>

            <div class="requirement-box">
                <strong>ğŸ“‹ æ§‹æˆ</strong>
                <ul>
                    <li><strong>1å¹´ç›®</strong>: å¹´é–“8æ™‚é–“ã®ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ </li>
                    <li><strong>2å¹´ç›®</strong>: å¹´é–“8æ™‚é–“ã®ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ </li>
                    <li><strong>3å¹´ç›®</strong>: å¹´é–“8æ™‚é–“ã®ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ </li>
                    <li><strong>4å¹´ç›®</strong>: å¹´é–“8æ™‚é–“ã®ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ </li>
                    <li><strong>5å¹´ç›®ä»¥é™</strong>: å¿…è¦ã«å¿œã˜ã¦</li>
                </ul>
            </div>

            <p style="margin-top: 1rem; color: #64748b; font-size: 0.95rem;">
                å„å¹´ã§ã€Œã“ã®è¬›åº§ã‚’å—ã‘ã•ã›ã‚Œã°è‰¯ã„ã€ã¨ã„ã†å½¢ã§ææ¡ˆè¡¨ã‚’ä½œæˆã—ã¾ã™ã€‚
            </p>

            <h3>2. è¬›åº§è©³ç´°ï¼ˆè‡ªå‹•ç”Ÿæˆã‚·ãƒ¼ãƒˆï¼‰</h3>
            <p style="margin-bottom: 1rem;">ææ¡ˆè¡¨ã§é¸ã‚“ã è¬›åº§åã«å¯¾å¿œã—ã¦ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’ä¸€è¦§åŒ–ã—ã¾ã™ã€‚</p>

            <div class="requirement-box">
                <strong>ğŸ“‹ è¨˜è¼‰å†…å®¹</strong>
                <ul>
                    <li>ã©ã‚“ãªå†…å®¹ã‹ï¼ˆè¬›åº§æ¦‚è¦ï¼‰</li>
                    <li>ä½•ãŒç†è§£ã§ãã‚‹ã®ã‹ï¼ˆåˆ°é”ç›®æ¨™ï¼‰</li>
                    <li>ãã®ä»–è©³ç´°æƒ…å ±</li>
                </ul>
            </div>

            <p style="margin-top: 1rem; color: #64748b; font-size: 0.95rem;">
                å¹´æ¬¡ãƒ»è·ç¨®ãŒå¤‰ã‚ã£ã¦ã‚‚ã€ææ¡ˆè¡¨ã«å…¥ã‚ŒãŸè¬›åº§ã«å¯¾å¿œã—ã¦è¬›åº§è©³ç´°ãŒè‡ªå‹•çš„ã«ä¸¦ã¶ã“ã¨ãŒç†æƒ³ã§ã™ã€‚
            </p>
        </div>

        <div class="section">
            <h2>ç¾çŠ¶ã¨èª²é¡Œ</h2>

            <div class="requirement-box">
                <strong>âš ï¸ ç¾çŠ¶</strong>
                <ul>
                    <li>Excelç®¡ç† / Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç®¡ç†ãŒæ··åœ¨</li>
                    <li>Apps Scriptã§ãƒ‡ãƒ¢çš„ãªã‚‚ã®ã¯å­˜åœ¨</li>
                    <li>æ‰‹ä½œæ¥­éƒ¨åˆ†ãŒå¤šãã€æ™‚é–“ãŒã‹ã‹ã‚‹</li>
                    <li>è¬›åº§è©³ç´°ã®è‡ªå‹•æ›´æ–°ãŒä¸å®Œå…¨</li>
                </ul>
            </div>

            <div class="goal-box">
                <strong>ğŸ¯ ç›®æ¨™</strong>
                <p>ã‚ˆã‚Šè‰¯ããƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚¢ãƒƒãƒ—ã—ã€æ¥­å‹™åŠ¹ç‡ã‚’å¤§å¹…ã«å‘ä¸Šã•ã›ãŸã„ã€‚</p>
            </div>
        </div>

        <div class="section">
            <h2>ã‚·ãƒ¼ãƒˆæ§‹æˆæ¡ˆ</h2>
            <p style="margin-bottom: 1.5rem;">ä»¥ä¸‹ã®ã‚·ãƒ¼ãƒˆæ§‹æˆã§ã€åŠ¹ç‡çš„ãªè³‡æ–™ä½œæˆã‚’å®Ÿç¾ã—ã¾ã™ã€‚</p>

            <div class="sheet-card">
                <h4>Sheet A: ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—æ•™è‚²ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆææ¡ˆè¡¨ï¼‰</h4>
                <p><strong>å½¹å‰²:</strong> è·ç¨®é¸æŠã€å¹´æ¬¡ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆ1å¹´æ¬¡ã€œ4å¹´æ¬¡ã€5å¹´ç›®ä»¥é™ï¼‰</p>
                <p><strong>æ©Ÿèƒ½:</strong> å„å¹´æ¬¡ã§ã€Œåˆè¨ˆ8æ™‚é–“ã€ã«ãªã‚‹ã‚ˆã†è¬›åº§ã‚’é…ç½®ã§ãã‚‹å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ </p>
            </div>

            <div class="sheet-card">
                <h4>Sheet B: è¬›åº§è©³ç´°ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰</h4>
                <p><strong>å½¹å‰²:</strong> Sheet Aã§é¸ã°ã‚ŒãŸè¬›åº§åã‚’ã‚‚ã¨ã«ã€è¬›åº§èª¬æ˜ãŒä¸€è¦§åŒ–ã•ã‚Œã‚‹</p>
                <p><strong>æ©Ÿèƒ½:</strong> è‡ªå‹•é€£å‹•ãƒ»è‡ªå‹•æ›´æ–°</p>
            </div>

            <div class="sheet-card">
                <h4>Sheet M: è¬›åº§ãƒã‚¹ã‚¿</h4>
                <p><strong>å½¹å‰²:</strong> å…¨è¬›åº§ã®åŸºç¤ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</p>
                <p><strong>å†…å®¹:</strong> è¬›åº§åã€æ™‚é–“æ•°ã€æ¦‚è¦ã€åˆ°é”ç›®æ¨™ã€ç´°éƒ¨è¨“ç·´é …ç›®ã€æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœãªã©</p>
            </div>

            <div class="sheet-card">
                <h4>Sheet C: é¡§å®¢æƒ…å ±/è¡¨ç´™ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</h4>
                <p><strong>å½¹å‰²:</strong> æå‡ºæ›¸é¡ã®è¡¨ç´™æƒ…å ±</p>
                <p><strong>å†…å®¹:</strong> ä¼šç¤¾åã€æå‡ºæ—¥ã€æ‹…å½“è€…ã€ç‰ˆæ•°ãªã©</p>
            </div>
        </div>

        <div class="section">
            <h2>è‡ªå‹•åŒ–è¦ä»¶ï¼ˆGAS/VBA ã§å®Ÿç¾ã—ãŸã„æ©Ÿèƒ½ï¼‰</h2>

            <h3>1. ææ¡ˆè¡¨é€£å‹•ã§ã®è¬›åº§è©³ç´°è‡ªå‹•æ›´æ–°</h3>
            <div class="requirement-box">
                <strong>æ©Ÿèƒ½</strong>
                <p>ææ¡ˆè¡¨ï¼ˆSheet Aï¼‰ã§è¬›åº§åã‚’é¸æŠãƒ»å¤‰æ›´ã™ã‚‹ã¨ã€è¬›åº§è©³ç´°ï¼ˆSheet Bï¼‰ãŒè‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã‚‹ã€‚</p>
            </div>

            <h3>2. å°åˆ·ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ•´å½¢ï¼ˆãƒœã‚¿ãƒ³1ã¤ã§å®Ÿè¡Œï¼‰</h3>
            <div class="requirement-box">
                <strong>æ©Ÿèƒ½</strong>
                <ul>
                    <li>å°åˆ·ç¯„å›²è¨­å®š</li>
                    <li>æ”¹ãƒšãƒ¼ã‚¸ä½ç½®ã®èª¿æ•´</li>
                    <li>ä½™ç™½è¨­å®š</li>
                    <li>ãƒ˜ãƒƒãƒ€ãƒ¼/ãƒ•ãƒƒã‚¿ãƒ¼è¨­å®š</li>
                    <li>ç¹°ã‚Šè¿”ã—è¡Œã®è¨­å®š</li>
                </ul>
            </div>

            <h3>3. ä¿è­·ï¼ˆç·¨é›†å¯èƒ½ç¯„å›²ã®åˆ¶å¾¡ï¼‰</h3>
            <div class="requirement-box">
                <strong>ç›®çš„</strong>
                <p>é¡§å®¢æå‡ºç”¨ã®å´©ã‚Œé˜²æ­¢ã€‚ç·¨é›†ã—ã¦è‰¯ã„ã‚»ãƒ«ï¼ˆå…¥åŠ›æ¬„ï¼‰ã®ã¿è¨±å¯ã€‚</p>
                <strong>å®Ÿè£…</strong>
                <ul>
                    <li>ã‚·ãƒ¼ãƒˆä¿è­·</li>
                    <li>ç¯„å›²ä¿è­·</li>
                    <li>å…¥åŠ›ã‚»ãƒ«ã®ã¿ç·¨é›†å¯èƒ½ã«è¨­å®š</li>
                </ul>
            </div>

            <h3>4. è¦‹ã‚„ã™ã•å‘ä¸Š</h3>
            <div class="requirement-box">
                <strong>æ©Ÿèƒ½</strong>
                <ul>
                    <li>ç½«ç·šã®è‡ªå‹•è¨­å®š</li>
                    <li>è¦‹å‡ºã—ã®å¼·èª¿è¡¨ç¤º</li>
                    <li>è‰²åˆ†ã‘ï¼ˆã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ»å¹´æ¬¡åˆ¥ï¼‰</li>
                    <li>å›ºå®šè¡¨ç¤ºï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®å›ºå®šï¼‰</li>
                    <li>å…¥åŠ›ã‚¬ã‚¤ãƒ‰ï¼ˆãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãƒ»ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ï¼‰</li>
                </ul>
            </div>

            <h3>5. PDFå‡ºåŠ›ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</h3>
            <div class="requirement-box">
                <strong>Google Apps Scriptã®å ´åˆ</strong>
                <p>PDFç”Ÿæˆã—ã¦Driveã«ä¿å­˜ã€ã¾ãŸã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å°ç·šã‚’æä¾›</p>
            </div>
        </div>

        <div class="section">
            <h2>ä¸»ãªãƒ•ãƒ­ãƒ¼ï¼ˆç¾å ´æ‰‹é †ï¼‰</h2>
            <p style="margin-bottom: 1.5rem;">ä»¥ä¸‹ã®æ‰‹é †ã§ã€é¡§å®¢æå‡ºè³‡æ–™ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

            <ol class="flow-list">
                <li class="flow-item">
                    <div class="flow-number"></div>
                    <div class="flow-content">
                        <div class="flow-title">è·ç¨®é¸æŠ</div>
                        <div class="flow-desc">å¯¾è±¡ã¨ãªã‚‹è·ç¨®ï¼ˆè£½é€ æ´¾é£ã€ç‰©æµæ´¾é£ã€äº‹å‹™æ´¾é£ãªã©ï¼‰ã‚’é¸æŠã—ã¾ã™ã€‚</div>
                    </div>
                </li>

                <li class="flow-item">
                    <div class="flow-number"></div>
                    <div class="flow-content">
                        <div class="flow-title">å¹´æ¬¡åˆ¥è¬›åº§ã®é¸æŠ</div>
                        <div class="flow-desc">1å¹´ç›®ã€œ5å¹´ç›®ä»¥é™ã¾ã§ã€å„å¹´åº¦ã§å¹´é–“8æ™‚é–“ã«ãªã‚‹ã‚ˆã†è¬›åº§ã‚’é¸æŠãƒ»é…ç½®ã—ã¾ã™ã€‚</div>
                    </div>
                </li>

                <li class="flow-item">
                    <div class="flow-number"></div>
                    <div class="flow-content">
                        <div class="flow-title">è¬›åº§è©³ç´°ã®è‡ªå‹•ç”Ÿæˆ</div>
                        <div class="flow-desc">é¸æŠã—ãŸè¬›åº§ã«å¯¾å¿œã—ã¦ã€è¬›åº§è©³ç´°ã‚·ãƒ¼ãƒˆãŒè‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚</div>
                    </div>
                </li>

                <li class="flow-item">
                    <div class="flow-number"></div>
                    <div class="flow-content">
                        <div class="flow-title">å°åˆ·ç”¨æ•´å½¢ï¼ˆãƒœã‚¿ãƒ³å®Ÿè¡Œï¼‰</div>
                        <div class="flow-desc">å°åˆ·ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ•´å½¢ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€å°åˆ·ç¯„å›²ãƒ»æ”¹ãƒšãƒ¼ã‚¸ãƒ»ç½«ç·šãªã©ã‚’è‡ªå‹•èª¿æ•´ã—ã¾ã™ã€‚</div>
                    </div>
                </li>

                <li class="flow-item">
                    <div class="flow-number"></div>
                    <div class="flow-content">
                        <div class="flow-title">ç¢ºèªãƒ»å¾®èª¿æ•´</div>
                        <div class="flow-desc">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦å¾®èª¿æ•´ã—ã¾ã™ã€‚</div>
                    </div>
                </li>

                <li class="flow-item">
                    <div class="flow-number"></div>
                    <div class="flow-content">
                        <div class="flow-title">PDFå‡ºåŠ›ãƒ»é¡§å®¢æå‡º</div>
                        <div class="flow-desc">PDFåŒ–ã—ã¦é¡§å®¢ã¸æå‡ºã—ã¾ã™ã€‚</div>
                    </div>
                </li>
            </ol>
        </div>

        <div class="section">
            <h2>æˆæœç‰©ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆâ‘¡ã®å®Œæˆå®šç¾©ï¼‰</h2>

            <div class="goal-box">
                <strong>âœ… å®Œæˆã®å®šç¾©</strong>
                <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                    <li>é¡§å®¢å‘ã‘ã«ãã®ã¾ã¾å‡ºã›ã‚‹ã€Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ææ¡ˆè¡¨ï¼‹è¬›åº§è©³ç´°ã€ãŒä½œã‚Œã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</li>
                    <li>A4ï¼ˆã¾ãŸã¯æŒ‡å®šã‚µã‚¤ã‚ºï¼‰ã§PDFåŒ–ã—ã¦ã‚‚å´©ã‚Œãšã€è¦‹æ „ãˆãŒè‰¯ã„</li>
                    <li>ä¿è­·ãŒåŠ¹ã„ã¦ãŠã‚Šã€æå‡ºç”¨ã®ä½“è£ãŒå´©ã‚Œã«ãã„</li>
                    <li>æ‰‹é †ãŒç°¡å˜ï¼ˆä¾‹ï¼šè·ç¨®é¸æŠâ†’è¬›åº§é¸æŠâ†’ãƒœã‚¿ãƒ³ã§æ•´å½¢â†’PDFå‡ºåŠ›ï¼‰</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>ä½¿ç”¨ãƒ„ãƒ¼ãƒ«ãƒ»æŠ€è¡“</h2>

            <div class="requirement-box">
                <strong>ğŸ“Œ å®Ÿè£…æ–¹é‡</strong>
                <p>è¦ä»¶ã«å¿œã˜ã¦ã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ï¼ˆã¾ãŸã¯ä¸¡å¯¾å¿œï¼‰ã‚’æ¤œè¨ã—ã¾ã™ã€‚</p>
                <ul>
                    <li><strong>Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ</strong>: Google Apps Scriptï¼ˆGASï¼‰</li>
                    <li><strong>Excel</strong>: VBAï¼ˆãƒã‚¯ãƒ­ï¼‰</li>
                </ul>
                <p style="margin-top: 0.5rem;">ç¾çŠ¶ãƒ‡ãƒ¢ãŒGASã®ãŸã‚ã€ã¾ãšGASã‚’ä¸»è»¸ã«è¨­è¨ˆã—ã¦OKã€‚</p>
            </div>
        </div>

        <div class="section">
            <h2>ç¾åœ¨ã®Apps Scriptã‚³ãƒ¼ãƒ‰ï¼ˆä¿ç®¡ç”¨ï¼‰</h2>
            <p style="margin-bottom: 1rem;">ä»¥ä¸‹ã¯ã€ç¾åœ¨ä½¿ç”¨ã—ã¦ã„ã‚‹Apps Scriptã®ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ä¸€è¨€ä¸€å¥å¤‰æ›´ã›ãšä¿ç®¡ã—ã¦ã„ã¾ã™ã€‚</p>

            <div class="code-block">
                <button class="copy-button" onclick="copyAppsScript()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                <div class="code-block-title">â–¼ ç¾åœ¨ã®Apps Scriptã‚³ãƒ¼ãƒ‰ï¼ˆå…¨æ–‡ï¼‰</div>
                <pre id="appsScript" style="white-space: pre-wrap; margin: 0;">/**
 * ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
 */
function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('â˜…ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«')
    .addItem('å…¨ã‚«ãƒ†ã‚´ãƒªä¸€æ‹¬ä½œæˆï¼ˆå…¨è‡ªå‹•ãƒ»å±¥æ­´ã‚ã‚Šï¼‰', 'createAllCategorySheetsHistory')
    .addSeparator() // åŒºåˆ‡ã‚Šç·š
    .addItem('ãƒŸã‚¹ãƒã‚§ãƒƒã‚¯ï¼ˆé¸æŠç¯„å›²ã‚’èµ¤ãï¼‰', 'checkTypos')
    .addItem('èµ¤è‰²ã‚’å…ƒã«æˆ»ã™ï¼ˆé¸æŠç¯„å›²ï¼‰', 'resetRedCells')
    .addSeparator() // åŒºåˆ‡ã‚Šç·š
    .addItem('ä½œæˆæ¸ˆã¿ã‚·ãƒ¼ãƒˆã‚’å…¨å‰Šé™¤ï¼ˆãŠæƒé™¤ï¼‰', 'deleteResultSheets')
    .addToUi();
}

/**
 * ã€ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½ã€‘
 * ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨å…¨ä½“ã‚’èª­ã¿è¾¼ã¿ã€ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ã‚·ãƒ¼ãƒˆã‚’è‡ªå‹•ä½œæˆã™ã‚‹
 * ï¼ˆåå¯„ã›ãƒ»é‡è¤‡å‰Šé™¤ãƒ»ä¸¦ã³æ›¿ãˆãƒ»å±¥æ­´ä¿å­˜æ©Ÿèƒ½ä»˜ãï¼‰
 */
function createAllCategorySheetsHistory() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();

  // â– è¨­å®šï¼šã‚·ãƒ¼ãƒˆåã®æŒ‡å®š
  const dbSheetName = 'DB';
  const scheduleSheetName = 'ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—æ•™è‚²ç ”ä¿®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«';

  // 1. DBã‚·ãƒ¼ãƒˆèª­ã¿è¾¼ã¿
  const dbSheet = ss.getSheetByName(dbSheetName);
  if (!dbSheet) {
    SpreadsheetApp.getUi().alert('ã‚¨ãƒ©ãƒ¼ï¼šã€ŒDBã€ã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã‚·ãƒ¼ãƒˆåã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
    return;
  }

  // DBãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã¨åˆ—ã®è‡ªå‹•æ¤œå‡º
  const lastRowDB = dbSheet.getLastRow();
  const lastColDB = dbSheet.getLastColumn();
  const dbData = dbSheet.getRange(1, 1, lastRowDB, lastColDB).getValues();
  const headers = dbData[0]; // 1è¡Œç›®ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ï¼‰

  // åˆ—åã‹ã‚‰ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ¢ã™ï¼ˆåˆ—ã‚ºãƒ¬å¯¾ç­–ï¼‰
  const getColIndex = (name) => headers.findIndex(h => String(h).includes(name));
  const colCategory = getColIndex('è¨“ç·´');             // Båˆ—æƒ³å®šï¼šè¨“ç·´åŒºåˆ†
  const colName     = getColIndex('å…·ä½“çš„ãªæ•™è‚²è¨“ç·´'); // Cåˆ—æƒ³å®šï¼šè¬›åº§å
  const colTime     = getColIndex('æ™‚é–“æ•°');           // Dåˆ—æƒ³å®šï¼šæ™‚é–“

  if (colCategory === -1 || colName === -1 || colTime === -1) {
    SpreadsheetApp.getUi().alert('ã‚¨ãƒ©ãƒ¼ï¼šDBã‚·ãƒ¼ãƒˆã«ã€Œè¨“ç·´ã€ã€Œå…·ä½“çš„ãªæ•™è‚²è¨“ç·´ã€ã€Œæ™‚é–“æ•°ã€ã¨ã„ã†åå‰ã®åˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
    return;
  }

  // æ–‡å­—ã®æ­£è¦åŒ–é–¢æ•°ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã‚„ã‚«ãƒƒã‚³ã‚’ç„¡è¦–ã—ã¦æ¯”è¼ƒã™ã‚‹ãŸã‚ï¼‰
  const normalize = (str) => String(str).replace(/[ ã€€]/g, "").replace(/[ã€Œã€ã€ã€\(\)ï¼ˆï¼‰\[\]]/g, "").trim();

  // è¾æ›¸ä½œæˆ
  const curriculumMap = {};
  for (let i = 1; i < dbData.length; i++) {
    const row = dbData[i];
    // ã‚­ãƒ¼ã‚’ã€Œè¬›åº§å_æ™‚é–“ã€ã«ã—ã¦ã€åŒåã§ã‚‚æ™‚é–“ãŒé•ãˆã°åŒºåˆ¥ã™ã‚‹
    const uniqueKey = normalize(row[colName]) + "_" + normalize(row[colTime]);
    if (normalize(row[colName])) {
      curriculumMap[uniqueKey] = row;
    }
  }

  // 2. ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨èª­ã¿è¾¼ã¿
  let activeSheet = ss.getActiveSheet();
  // DBã‚·ãƒ¼ãƒˆã‚„ä½œæˆæ¸ˆã¿ã‚·ãƒ¼ãƒˆã‚’é–‹ã„ã¦ã„ã‚‹å ´åˆã¯ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ã‚’è‡ªå‹•ã§æ¢ã—ã«è¡Œã
  if (activeSheet.getName() === dbSheetName || activeSheet.getName().includes('å°åˆ·ç”¨è©³ç´°')) {
    activeSheet = ss.getSheetByName(scheduleSheetName);
    if (!activeSheet) {
      // åå‰ã§è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã€ä¸€ç•ªå·¦ã®ã‚·ãƒ¼ãƒˆã‚’ä»®å®š
      activeSheet = ss.getSheets()[0];
    }
  }

  const range = activeSheet.getDataRange();
  const values = range.getValues();

  // ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®ãƒ‡ãƒ¼ã‚¿æ ¼ç´ç”¨
  let categorizedRows = {};
  let currentCategory = "ãã®ä»–";

  // 3. ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ã‚’ã‚¹ã‚­ãƒ£ãƒ³ï¼†åå¯„ã›
  values.forEach(row => {
    // Aåˆ—ã‚’è¦‹ã¦ã‚«ãƒ†ã‚´ãƒªåˆ¤å®š
    let cellA = String(row[0]).trim();

    // é™¤å¤–ãƒ¯ãƒ¼ãƒ‰ã§ãªã‘ã‚Œã°ã‚«ãƒ†ã‚´ãƒªæ›´æ–°ã®ãƒãƒ£ãƒ³ã‚¹
    if (cellA && !cellA.includes("å¹´ç›®") && !cellA.includes("åˆè¨ˆ") && !cellA.includes("ä½œæˆ")) {

      // â˜…åå¯„ã›ãƒ­ã‚¸ãƒƒã‚¯
      if (cellA.includes("è£½é€ ")) {
        currentCategory = "è£½é€ æ´¾é£";
      } else if (cellA.includes("ç‰©æµ")) {
        currentCategory = "ç‰©æµæ´¾é£";
      } else if (cellA.includes("äº‹å‹™") || cellA.includes("ã‚ªãƒ•ã‚£ã‚¹") || cellA.includes("PC")) {
        currentCategory = "äº‹å‹™æ´¾é£";
      } else if (cellA.includes("æ¸…æƒ")) {
        currentCategory = "æ¸…æƒæ´¾é£";
      } else if (cellA.includes("è²©å£²") || cellA.includes("æ¥å®¢")) {
        currentCategory = "è²©å£²æ¥å®¢æ´¾é£";
      } else if (cellA.includes("ä»‹è­·") || cellA.includes("ç¦ç¥‰")) {
        currentCategory = "ä»‹è­·ç¦ç¥‰æ´¾é£";
      } else if (cellA.includes("IT") || cellA.includes("ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢")) {
        currentCategory = "ITã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æ´¾é£";
      } else {
        // ãã‚Œä»¥å¤–ã¯ãã®ã¾ã¾ã®åå‰ã‚’ä½¿ã†
        currentCategory = cellA.replace(/[\r\n]/g, "");
      }
    }

    // è¡Œã®ä¸­ã®ã‚»ãƒ«ã‚’é †ç•ªã«è¦‹ã¦è¬›åº§ã‚’æŠ½å‡º
    row.forEach(cellValue => {
      const cleanName = normalize(cellValue);
      // DBè¾æ›¸ã‹ã‚‰æ¢ã™
      for (const [uniqueKey, dbRow] of Object.entries(curriculumMap)) {
        // å‰æ–¹ä¸€è‡´ã§ãƒ’ãƒƒãƒˆã•ã›ã‚‹ï¼ˆè¬›åº§åãŒåˆã£ã¦ã„ã‚Œã°OKï¼‰
        if (uniqueKey.startsWith(cleanName + "_")) {

          // ã‚«ãƒ†ã‚´ãƒªã®ç®±ãŒãªã‘ã‚Œã°ä½œã‚‹
          if (!categorizedRows[currentCategory]) {
            categorizedRows[currentCategory] = { rows: [], seen: new Set() };
          }

          // é‡è¤‡ãƒã‚§ãƒƒã‚¯ï¼šã¾ã ãã®ã‚«ãƒ†ã‚´ãƒªã«å…¥ã£ã¦ã„ãªã‘ã‚Œã°è¿½åŠ 
          if (!categorizedRows[currentCategory].seen.has(uniqueKey)) {
            categorizedRows[currentCategory].rows.push(dbRow);
            categorizedRows[currentCategory].seen.add(uniqueKey);
          }
          break; // 1ã¤ã®ã‚»ãƒ«ã«ã¤ã1ãƒ’ãƒƒãƒˆã§æ¬¡ã¸
        }
      }
    });
  });

  // 4. ã‚·ãƒ¼ãƒˆå‡ºåŠ›å‡¦ç†
  const categories = Object.keys(categorizedRows);
  if (categories.length === 0) {
    SpreadsheetApp.getUi().alert('è¬›åº§ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\nAåˆ—ã«ã€Œè£½é€ æ´¾é£ã€ãªã©ã®ã‚«ãƒ†ã‚´ãƒªåãŒå…¥ã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
    return;
  }

  // ç¾åœ¨æ™‚åˆ»ã‚’å–å¾—ï¼ˆã‚·ãƒ¼ãƒˆåã«ä½¿ç”¨ï¼‰
  const now = new Date();
  const timeString = Utilities.formatDate(now, Session.getScriptTimeZone(), "MMdd_HHmm");
  let logMessage = "ã€ä½œæˆå®Œäº†ãƒ¬ãƒãƒ¼ãƒˆã€‘\n";

  categories.forEach(catName => {
    const data = categorizedRows[catName];
    if (data.rows.length === 0) return;

    // ä¸¦ã³æ›¿ãˆï¼ˆå…¥è·æ™‚â†’è·èƒ½åˆ¥â†’è·ç¨®è»¢æ›â†’éšå±¤åˆ¥ï¼‰
    data.rows.sort((a, b) => {
      const getPriority = (row) => {
        const c = String(row[colCategory]);
        if (c.includes('å…¥è·æ™‚')) return 1;
        if (c.includes('è·èƒ½åˆ¥')) return 2;
        if (c.includes('è·ç¨®è»¢æ›')) return 3;
        if (c.includes('éšå±¤åˆ¥')) return 4;
        return 99;
      };
      return getPriority(a) - getPriority(b);
    });

    // æ–°ã—ã„ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
    const sheetName = 'å°åˆ·ç”¨è©³ç´°_' + catName + '_' + timeString;
    const targetSheet = ss.insertSheet();
    targetSheet.setName(sheetName);

    // ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ‡ãƒ¼ã‚¿ã‚’çµåˆï¼ˆå¿…è¦ãª6åˆ—åˆ†ã®ã¿ï¼‰
    const headerRow = [['é …ç›®ç•ªå·', 'è¨“ç·´', 'å…·ä½“çš„ãªæ•™è‚²è¨“ç·´', 'æ™‚é–“æ•°', 'ç´°éƒ¨è¨“ç·´é …ç›®ï¼ˆæ•™è‚²è¨“ç·´ã®å†…å®¹ãŒã‚ã‹ã‚‹äº‹é …ï¼‰', 'ãƒ»æœŸå¾…ã•ã‚Œã‚‹æ•™è‚²è¨“ç·´ã®åŠ¹æœãƒ»åˆ°é”ã™ã¹ãçŸ¥è­˜ã€æŠ€é‡ãƒ¬ãƒ™ãƒ«ãƒ»ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—ã«ã¤ãªãŒã‚‹ç†ç”±']];
    const cleanRows = data.rows.map(r => r.slice(0, 6));
    const finalOutput = headerRow.concat(cleanRows);

    // æ›¸ãè¾¼ã¿
    const totalRows = finalOutput.length;
    const targetRange = targetSheet.getRange(1, 1, totalRows, 6);
    targetRange.setValues(finalOutput);

    // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆèª¿æ•´
    targetSheet.setColumnWidth(1, 50);  targetSheet.setColumnWidth(2, 100);
    targetSheet.setColumnWidth(3, 200); targetSheet.setColumnWidth(4, 80);
    targetSheet.setColumnWidth(5, 300); targetSheet.setColumnWidth(6, 300);

    targetRange.setWrapStrategy(SpreadsheetApp.WrapStrategy.WRAP);

    // é…ç½®ï¼šAã€œDåˆ—ã¯ä¸­å¤®ã€Eã€œFåˆ—ã¯å·¦ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ã¯ä¸­å¤®ï¼‰
    targetSheet.getRange(1, 1, totalRows, 4).setHorizontalAlignment('center').setVerticalAlignment('middle');
    targetSheet.getRange(1, 5, 1, 2).setHorizontalAlignment('center').setVerticalAlignment('middle');
    if (totalRows >= 2) {
      targetSheet.getRange(2, 5, totalRows - 1, 2).setHorizontalAlignment('left').setVerticalAlignment('middle');
    }

    // ç½«ç·š
    targetSheet.getDataRange().setBorder(true, true, true, true, true, true);

    logMessage += `ãƒ»ã€Œ${sheetName}ã€ã‚’ä½œæˆï¼ˆ${data.rows.length}ä»¶ï¼‰\n`;
  });

  SpreadsheetApp.getUi().alert(logMessage);
}

/**
 * ã€ã‚µãƒ–æ©Ÿèƒ½1ã€‘
 * é¸æŠç¯„å›²ã®ä¸­ã ã‘ã€å…¥åŠ›ãƒŸã‚¹ï¼ˆDBã«ãªã„è¬›åº§ï¼‰ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦èµ¤ãå¡—ã‚‹
 */
function checkTypos() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const dbSheetName = 'DB';

  // DBã‹ã‚‰æ­£ã—ã„è¬›åº§ãƒªã‚¹ãƒˆã‚’å–å¾—
  const dbSheet = ss.getSheetByName(dbSheetName);
  if (!dbSheet) {
    SpreadsheetApp.getUi().alert('ã‚¨ãƒ©ãƒ¼ï¼šã€ŒDBã€ã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
    return;
  }
  const dbValues = dbSheet.getDataRange().getValues();
  const validKeys = new Set();
  const normalize = (str) => String(str).replace(/[ ã€€]/g, "").replace(/[ã€Œã€ã€ã€\(\)ï¼ˆï¼‰\[\]]/g, "").trim();

  // DBã®å…¨æ–‡å­—ã‚’ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¨ã—ã¦ç™»éŒ²ï¼ˆç°¡æ˜“ãƒãƒƒãƒãƒ³ã‚°ç”¨ï¼‰
  dbValues.forEach(row => {
    row.forEach(cell => {
       const name = normalize(cell);
       if (name && name.length > 2) validKeys.add(name);
    });
  });

  // é¸æŠç¯„å›²ã‚’å–å¾—
  let activeSheet = ss.getActiveSheet();
  const selection = activeSheet.getSelection().getActiveRange();

  if (!selection) {
    SpreadsheetApp.getUi().alert('ã‚¨ãƒ©ãƒ¼ï¼šãƒã‚§ãƒƒã‚¯ã—ãŸã„ç¯„å›²ï¼ˆè¬›åº§åã®åˆ—ãªã©ï¼‰ã‚’é¸æŠã—ã¦ã‹ã‚‰å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚');
    return;
  }

  const values = selection.getValues();
  const backgrounds = selection.getBackgrounds();

  let errorCount = 0;

  // é¸æŠç¯„å›²ã‚’æ¤œæŸ»
  for (let r = 0; r < values.length; r++) {
    for (let c = 0; c < values[r].length; c++) {
      const cellValue = String(values[r][c]).trim();

      // ç„¡è¦–ã™ã‚‹è¨€è‘‰ãƒªã‚¹ãƒˆ
      if (cellValue === "" || cellValue.includes("å¹´ç›®") || cellValue.includes("åˆè¨ˆ") || cellValue.includes("æ´¾é£") || cellValue.includes("ä½œæˆ") || cellValue.includes("æ™‚é–“") || cellValue.includes("å†…å®¹")) {
        backgrounds[r][c] = null; // è‰²ã‚’ãƒªã‚»ãƒƒãƒˆ
        continue;
      }

      const cleanName = normalize(cellValue);
      let found = false;
      // DBãƒªã‚¹ãƒˆã¨ç…§åˆ
      for (const dbKey of validKeys) {
        if (dbKey && cleanName.includes(dbKey)) {
          found = true;
          break;
        }
      }

      if (found) {
        backgrounds[r][c] = null; // æ­£ã—ã‘ã‚Œã°è‰²ãªã—
      } else {
        backgrounds[r][c] = '#FFCCCC'; // é–“é•ã„ãªã‚‰èµ¤
        errorCount++;
      }
    }
  }

  // çµæœåæ˜ 
  selection.setBackgrounds(backgrounds);

  if (errorCount > 0) {
    SpreadsheetApp.getUi().alert('ãƒã‚§ãƒƒã‚¯å®Œäº†ï¼š\né¸æŠç¯„å›²å†…ã« ' + errorCount + 'ç®‡æ‰€ã®å…¥åŠ›ãƒŸã‚¹ï¼ˆDBã«ãªã„è¬›åº§ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚\nèµ¤è‰²ã®ã‚»ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
  } else {
    SpreadsheetApp.getUi().alert('OKï¼\né¸æŠç¯„å›²å†…ã®è¬›åº§åã¯ã™ã¹ã¦DBã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚');
  }
}

/**
 * ã€ã‚µãƒ–æ©Ÿèƒ½2ã€‘
 * é¸æŠç¯„å›²å†…ã®ã€Œèµ¤è‰²ã€ã ã‘ã‚’æ¶ˆã—ã¦å…ƒã«æˆ»ã™
 */
function resetRedCells() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const activeSheet = ss.getActiveSheet();
  const selection = activeSheet.getSelection().getActiveRange();

  if (!selection) {
    SpreadsheetApp.getUi().alert('ã‚¨ãƒ©ãƒ¼ï¼šè‰²ã‚’æˆ»ã—ãŸã„ç¯„å›²ã‚’é¸æŠã—ã¦ã‹ã‚‰å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚');
    return;
  }

  const backgrounds = selection.getBackgrounds();
  let count = 0;

  for (let r = 0; r < backgrounds.length; r++) {
    for (let c = 0; c < backgrounds[r].length; c++) {
      // è–„ã„èµ¤è‰²ï¼ˆ#ffccccï¼‰ã ã‘ã‚’ç‹™ã„æ’ƒã¡ã§æ¶ˆã™
      if (backgrounds[r][c] == '#ffcccc' || backgrounds[r][c] == '#FFCCCC') {
        backgrounds[r][c] = null;
        count++;
      }
    }
  }

  selection.setBackgrounds(backgrounds);

  if (count > 0) {
    SpreadsheetApp.getUi().alert('å®Œäº†ï¼š\né¸æŠç¯„å›²å†…ã® ' + count + 'ç®‡æ‰€ã®èµ¤è‰²ã‚’å…ƒã«æˆ»ã—ã¾ã—ãŸã€‚');
  } else {
    SpreadsheetApp.getUi().alert('é¸æŠç¯„å›²å†…ã«ã€æˆ»ã™ã¹ãèµ¤è‰²ã®ã‚»ãƒ«ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚');
  }
}

/**
 * ã€ã‚µãƒ–æ©Ÿèƒ½3ã€‘
 * ã€Œå°åˆ·ç”¨è©³ç´°ã€ã§å§‹ã¾ã‚‹ã‚·ãƒ¼ãƒˆã‚’ã¾ã¨ã‚ã¦å‰Šé™¤ã™ã‚‹ãŠæƒé™¤æ©Ÿèƒ½
 */
function deleteResultSheets() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheets = ss.getSheets();
  let count = 0;
  const ui = SpreadsheetApp.getUi();
  const response = ui.alert('ç¢ºèª', 'ã€Œå°åˆ·ç”¨è©³ç´°ã€ã§å§‹ã¾ã‚‹ä½œæˆæ¸ˆã¿ã‚·ãƒ¼ãƒˆã‚’ã™ã¹ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nï¼ˆã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ï¼‰', ui.ButtonSet.YES_NO);

  if (response == ui.Button.YES) {
    sheets.forEach(sheet => {
      if (sheet.getName().startsWith('å°åˆ·ç”¨è©³ç´°')) {
        ss.deleteSheet(sheet);
        count++;
      }
    });
    ui.alert(count + 'æšã®ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚');
  }
}</pre>
            </div>
        </div>

        <div class="nav-buttons">
            <a href="project01.html" class="btn btn-secondary">â† å‰ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</a>
            <a href="project03.html" class="btn">æ¬¡ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ â†’</a>
        </div>
    </div>

    <script>
        function copyAppsScript() {
            const text = document.getElementById('appsScript').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('Apps Scriptã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
            });
        }
    </script>
</body>

</html>
